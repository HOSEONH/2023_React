// 16.8ë²„ì „ ì´í›„ë¡œ í•¨ìˆ˜í˜•ì—ì„œ state ì‚¬ìš© ê°€ëŠ¥
import { useState } from "react";

// cssíŒŒì¼ ë“¤ê³ ì˜¤ê¸°
import './arrowState.css'

// í™”ë©´ì˜ ì—…ë°ì´íŠ¸ì— ìƒê´€ì—†ì´ ì‚¬ìš©í•˜ëŠ” ë³€ìˆ˜
// í˜„ì¬ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì „ì—­ë³€ìˆ˜ë¡œ ì“¸ ë³€ìˆ˜
let globalId = 4;

// í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ì˜ íŠ¹ì§•
// 1) thisë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤
// 2) ì•ˆì— ê°’ì„ ë„£ì–´ì¤„ ë•Œ ë³€ìˆ˜ë¡œ í• ë‹¹í•˜ë¯€ë¡œ constë‚˜ let ì‚¬ìš©
const ArrowState = (props) => {
    // useStateëŠ” í•­ìƒ í•¨ìˆ˜(ì»´í¬ë„ŒíŠ¸)ì•ˆì— ì‘ì„±
    const [message, setMessage] = useState(
        {
            time : "10:53",
            text : "ë©”ì‹œì§€ ì…ë‹ˆë‹¤ ğŸ¥¨"
        });
    // useStateëŠ” ì—¬ëŸ¬ë²ˆ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤
    const [number, setNumber] = useState(0);
    const [array, setArray] = useState([1, 2, 3, 4]);

    // mapì„ ì´ìš©í•˜ì—¬ idê°’ê³¼ nameì„ í™”ë©´ì— ì¶œë ¥
    const [students, setStudents] = useState(
        [
            {id : 1, name : "ìë‘", checked : true},
            {id : 2, name : "ë¯¼ì§€", checked : false},
            {id : 3, name : "ëŒëŒì´", checked : false} // ë°ì´í„° ê¸°ì¤€ìœ¼ë¡œ ìƒê° ê°¯ìˆ˜ë§Œí¼ ì²´í¬ ! ë§Œë“¤ê¸°
        ]
    );
    // í•™ìƒ ì´ë¦„ì„ ë°›ì•„ì˜¬ ê³µê°„
    const [inputName, setInputName] = useState("");

    // í´ë˜ìŠ¤í˜•ì—ì„œ render()ì•ˆì— ê°’ì´ ê³„ì† ì´ˆê¸°í™”
    // í•¨ìˆ˜í˜• í´ë˜ìŠ¤ì—ì„œëŠ” í•¨ìˆ˜ ì•ˆì— ìˆëŠ” ë‚´ìš©ì´ ê³„ì† ì´ˆê¸°í™”
    let id = 4;


    // ë©”ì†Œë“œ ì‘ì„±
    const inputChange = (e)=>{setInputName(e.target.value)}
    // const inputChange = function(e){setInputName(e.target.value)}

    const addStudent = () => { // ğŸˆì—¬ê¸°ì— ë§Œë“¤ê³  ë„£ì–´ì¤€ë‹¤
        // ê°’ì„ ë°›ì•„ì™€ì„œ ìƒˆë¡œìš´ ë°°ì—´ë¡œ ë§Œë“¤ê¸°
        // ìƒˆë¡œìš´ ë°°ì—´ students í• ë‹¹
        const newStudents = students.concat ( // ìƒˆë¡œìš´ ë°°ì—´ì´ ë“¤ì–´ê°ˆ ê³µê°„ ë§Œë“¤ê¸° // ìƒˆë¡œìš´ ë°°ì—´ ë§Œë“¤ê¸° .concat
            {
                id : globalId,
                name : inputName
            }
        ); 
        globalId++;
        setStudents(newStudents); // ì´ ë¶€ë¶„ ì–´ë–»ê²Œ ì§„í–‰ë˜ëŠ”ê±°ì§€
        setInputName(""); // ê¸€ìê°€ ì§€ì›Œì§€ë„ë¡ // ì—¬ê¸° ë„£ì–´ì¤€ ê°’ì„ ë“¤ê³  ğŸ‘½
    }

    // idê°’ì„ ì „ë‹¬í•˜ì—¬ ë©”ì†Œë“œ ì•ˆì—ì„œ ì‚¬ìš©
    const deleteStudent = (id) =>{ // (id) ê´„í˜¸ì•ˆì— idë„£ì–´ì„œ ì‚¬ìš©í•˜ëŠ” ê±°ë‘ ê·¸ëƒ¥ idë¼ê³  í•˜ëŠ”ê±°ë‘ ë­ê°€ ì–´ë–»ê²Œ ë‹¤ë¥¸ì§€..?
        // í´ë¦­í–ˆì„ ë•Œ ë°°ì—´ ì‚­ì œ
        // í´ë¦­í•œ idê°’ì„ ì œì™¸í•˜ê³  ìƒˆë¡œìš´ ë°°ì—´ ì‘ì„±
        // filter
        const newStudents = students.filter(
            (s)=>s.id !== id
        )
        setStudents(newStudents);
    }

    return (
        <div>
            {/* textë§Œ ë“¤ê³  ì˜¬ ìˆ˜ ìˆë„ë¡ ? ì™œ ê·¸ë ‡ê²Œ í•œë‹¤ê³  ê·¸ë¬ì§€ ? ! */}
            <p>{number}, {message.text}</p>
            <button
                // useStateë¡œ ì‘ì„±í•œ í•¨ìˆ˜ë¥¼ í†µí•´ì„œ ê°’ì„ ë„£ì–´ì¤„ ë–„
                // ê·¸ ê°’ì˜ ìë£Œí˜•ì´ ê°™ì§€ ì•Šì•„ë„ ë„£ì–´ì¤€ë‹¤
                // ì‘ì„±í•  ë•Œ ê·¸ ê°’ì˜ ìë£Œí˜•ì„ í™•ì¸í•˜ê³  ë™ì¼í•œ í˜•íƒœë¡œ í• ë‹¹ 
                // ê°ì²´ì˜ ì¼ë¶€ë¶„ë§Œ ìˆ˜ì •í•´ì„œ ë„£ì„ ë•Œ ì‚¬ìš©í•˜ëŠ” ì—°ì‚°ì : ...
                // ...(ìŠ¤í”„ë ˆë“œ ì—°ì‚°ì ì‚¬ìš©)
                // : ê°ì²´ë‚˜ ë°°ì—´ì•ˆì— ìˆëŠ” ê°’(ìš”ì†Œ)ì„ êº¼ë‚´ì„œ ì‚¬ìš©
                // ê°ì²´ì—ì„œ ë™ì¼í•œ ì†ì„±ì´ë¦„ì„ ì‚¬ìš©í•˜ë©´ ë§ˆì§€ë§‰ì— ì ì€ ê°’ ì‚¬ìš©
                onClick={()=>{setMessage({...message, text:"ğŸ¥¨ ìˆ˜ì •ëœ ë‚´ìš©"})}} // setMessageëŠ” í•¨ìˆ˜ë¼ì„œ ? ë°”ê¿€ ë‚´ìš©ë„£ì–´ ìˆ˜ì •í•  ìˆ˜ ìˆë‹¤ 
            >
                ê¸€ìê°’ ìˆ˜ì • ğŸ¥¨
            </button>
            {
                array.map((num, i)=><li key={i}> {num} </li>)
            }
            <h3>í•™ìƒì¶”ê°€</h3>
            <input
                type="text"
                onChange={inputChange}
                value={inputName} // ğŸ‘½ì—¬ê¸°ì— ë„£ì–´ì¤€ë‹¤
            />
            <button
                onClick={addStudent} // ì˜ë¼ë‚¸ ë‚´ìš©ì„ ê°€ì§€ê³  ğŸˆ
            >
                ì¶”ê°€
            </button>
            <ul>
            {
                students.map((student)=>
                <li
                    key={student.id}
                    className={ student.checked ? "on" : "" } // css ìŠ¤íƒ€ì¼ ì ìš©
                >
                    <input type="checkbox"
                        // checked={true} // ê³ ì •ëœ ê°’ì´ ì•„ë‹Œ ë°”ê¿€ ìˆ˜ ìˆëŠ” ê°’ìœ¼ë¡œ ë„£ì–´ì¤˜ì•¼ í•œë‹¤.
                        checked={student.checked} // ê³ ì •ë˜ì–´ í´ë¦­ì´ ë¶ˆê°€ 
                        readOnly // ì½ê¸°ë§Œ í•˜ê² ë‹¤ // ì´ê²Œ ë­ì•¼ ì™œ ì‚¬ìš©í•˜ëŠ”ê±°ì§€
                        onClick={()=>{ // onClick ì´ë²¤íŠ¸ë¥¼ ì¶”ê°€í•´ì„œ ë°”ê¾¸ì–´ ì¤€ë‹¤ í´ë¦­í•  ìˆ˜ ìˆë„ë¡!
                            // ì²´í¬ë°•ìŠ¤ë¥¼ í´ë¦­í•˜ë©´, í´ë¦­í•œ ê°ì²´ì˜ checked ê°’ì´ ë°”ë€œ
                            // ë°°ì—´ì„ ì¶”ê°€í•˜ê±°ë‚˜ ì‚­ì œí•˜ëŠ” ê²ƒì´ ì•„ë‹Œ ê°ì²´ì˜ ë‚´ìš©ì„ ë°”ê¾¼ë‹¤?
                            // mapì„ ì´ìš©í•˜ì—¬ ì‘ì„±
                            // map() : ë°°ì—´ì•ˆì˜ ìš”ì†Œì˜ ê°’ì„ returnì„ í†µí•´ ìƒˆë¡œìš´ ë°°ì—´ ë§Œë“¦
                            // í´ë¦­í•œ ê°ì²´ë¥¼ ì°¾ì•˜ë‹¤ë©´ > ê·¸ ê°ì²´ì˜ checked ê°’ì„ ìˆ˜ì •í•´ì„œ return
                            const newStudents = students.map((s)=>{ // ë°°ì—´ ì „ë‹¬ ğŸ˜¸
                                // sí†µí•´ ê°ê°ì˜ ê°ì²´ ê°’ í™•ì¸ // ê°ê°ì˜ ê°ì²´ ê°’ì´ ì–´ë–»ê²Œ í™•ì¸ë˜ëŠ”ê±°ì§€?!
                                // 1) í´ë¦­í•œ ì²´í¬ë°•ìŠ¤ì˜ idê°’ê³¼ ëª¨ë“  sì˜ idì™€ ë¹„êµ
                                // 2) id ê°’ì´ ê°™ì§€ ì•Šë‹¤ë©´ ì›ë˜ ê°ì²´ ë¥¼ ëŒë ¤ì£¼ê¸°
                                // 3) id ê°’ì´ ê°™ë‹¤ë©´ checked ê°’ì„ !ì„ ì´ìš©í•˜ì—¬ ìˆ˜ì •í•œ ê°ì²´ // ë¬´ìŠ¨ ë§ì¼ê¹Œë‚˜
                                if(student.id !== s.id) {
                                    return s;
                                } else {
                                    // ì›ë˜ ê°ì²´ì—ì„œ checked ê°’ë§Œ ìˆ˜ì •í•˜ê¸° ìœ„í•´ì„œ
                                    // sì•ˆì— ìˆëŠ” ì†ì„±ì„ ...(ìŠ¤í”„ë ˆë“œ ì—°ì‚°ì)ë¥¼ ì´ìš©í•´ì„œ ì¶”ê°€
                                    // ìˆ˜ì •í•  ì†ì„±ì¸ checkedë¥¼ ì‘ì„±í•´ì„œ ìˆ˜ì •
                                    return {...s, checked : !s.checked } // ê·¸ëŸ¼ ì´ê²Œ checkedëŠ” s.checkedê°€ ì•„ë‹ˆë‹¤? ë§ë‚˜..
                                }
                            })
                            setStudents(newStudents) // ë“¤ê³ ì˜´ ğŸ˜¸ // ì™œ ë“¤ê³ ì™€ì•¼í•´..?
                        }}
                    />
                    {student.id}. {student.name}
                    <button
                        // í´ë¦­í–ˆì„ ë•Œ ë°°ì—´ ì‚­ì œ > í´ë˜ìŠ¤í˜• ì»´í¬ë„ŒíŠ¸ ë‚´ìš© ì°¸ê³ 
                        onClick={()=>{deleteStudent(student.id)}} // ëª¨ë¥´ê² ë‹¤ ì™œ students.id ë“¤ê³ ì™€ì„œ ì™œ ()ì“°ê³  ì™œ í™”ì‚´í‘œ í•¨ìˆ˜ ì“°ëŠ”ê²…ì§€ 
                    >
                        X
                    </button>
                </li>)
            }
            </ul>

        </div>
    )
}

export default ArrowState;
